(()=>{"use strict";var e,a={865(e,a,t){const s=window.React,n=window.wp.element,l=window.wp.components,c=window.wp.i18n,i=({backups:e,onDelete:a,onDownload:t,onRestore:n})=>{const l=e=>{switch(e){case"full":return"type-full";case"database":return"type-database";case"files":return"type-files";default:return""}};return e&&0!==e.length?(0,s.createElement)("div",{className:"swish-backup-list"},(0,s.createElement)("h2",null,(0,c.__)("Recent Backups","swish-migrate-and-backup")),(0,s.createElement)("table",{className:"wp-list-table widefat fixed striped"},(0,s.createElement)("thead",null,(0,s.createElement)("tr",null,(0,s.createElement)("th",{className:"column-filename"},(0,c.__)("Backup","swish-migrate-and-backup")),(0,s.createElement)("th",{className:"column-type"},(0,c.__)("Type","swish-migrate-and-backup")),(0,s.createElement)("th",{className:"column-size"},(0,c.__)("Size","swish-migrate-and-backup")),(0,s.createElement)("th",{className:"column-date"},(0,c.__)("Created","swish-migrate-and-backup")),(0,s.createElement)("th",{className:"column-actions"},(0,c.__)("Actions","swish-migrate-and-backup")))),(0,s.createElement)("tbody",null,e.map(e=>(0,s.createElement)("tr",{key:e.id},(0,s.createElement)("td",{className:"column-filename"},(0,s.createElement)("strong",null,e.filename||e.id)),(0,s.createElement)("td",{className:"column-type"},(0,s.createElement)("span",{className:`swish-backup-type ${l(e.type)}`},(e=>{switch(e){case"full":return(0,c.__)("Full Backup","swish-migrate-and-backup");case"database":return(0,c.__)("Database","swish-migrate-and-backup");case"files":return(0,c.__)("Files Only","swish-migrate-and-backup");default:return e}})(e.type))),(0,s.createElement)("td",{className:"column-size"},(e=>{if(0===e)return"0 Bytes";const a=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,a)).toFixed(2))+" "+["Bytes","KB","MB","GB"][a]})(e.size)),(0,s.createElement)("td",{className:"column-date"},(e=>{if(!e)return"-";const a=new Date(e);return a.toLocaleDateString()+" "+a.toLocaleTimeString()})(e.completed_at||e.created_at)),(0,s.createElement)("td",{className:"column-actions"},(0,s.createElement)("div",{className:"swish-action-buttons"},(0,s.createElement)("button",{className:"button button-small",onClick:()=>n(e.id),title:(0,c.__)("Restore","swish-migrate-and-backup")},(0,s.createElement)("span",{className:"dashicons dashicons-backup"}),(0,c.__)("Restore","swish-migrate-and-backup")),(0,s.createElement)("button",{className:"button button-small",onClick:()=>t(e.id),title:(0,c.__)("Download","swish-migrate-and-backup")},(0,s.createElement)("span",{className:"dashicons dashicons-download"})),(0,s.createElement)("button",{className:"button button-small button-link-delete",onClick:()=>a(e.id),title:(0,c.__)("Delete","swish-migrate-and-backup")},(0,s.createElement)("span",{className:"dashicons dashicons-trash"}))))))))):(0,s.createElement)("div",{className:"swish-backup-list"},(0,s.createElement)("h2",null,(0,c.__)("Recent Backups","swish-migrate-and-backup")),(0,s.createElement)("div",{className:"swish-empty-state"},(0,s.createElement)("span",{className:"dashicons dashicons-backup"}),(0,s.createElement)("p",null,(0,c.__)("No backups yet. Create your first backup to get started.","swish-migrate-and-backup"))))},r=window.wp.apiFetch;var o=t.n(r);const m=async(e,a={})=>{const t=`/swish-backup/v1${e}`;try{return await o()({path:t,...a})}catch(e){if(e.message)throw new Error(e.message);throw e}},u=()=>m("/stats"),d=()=>m("/backups"),h=(e="full",a={})=>m("/backup",{method:"POST",data:{type:e,...a}}),p=e=>m(`/backup/${e}`,{method:"DELETE"}),b=e=>m(`/backup/${e}/download`),_=(e,a={})=>m("/restore",{method:"POST",data:{backup_id:e,restore_database:!0,restore_files:!0,...a}}),g=(e,a,t=!1)=>m("/search-replace",{method:"POST",data:{search:e,replace:a,dry_run:t}}),w=e=>m(`/job/${e}`),k=()=>m("/settings"),E=e=>m("/settings",{method:"POST",data:e}),N=({siteUrl:e})=>{const[a,t]=(0,n.useState)(""),[l,i]=(0,n.useState)(e||""),[r,o]=(0,n.useState)(null),[m,u]=(0,n.useState)(!1),[d,h]=(0,n.useState)(null),[p,b]=(0,n.useState)(null);return(0,s.createElement)("div",{className:"swish-migrate-panel"},(0,s.createElement)("h3",null,(0,c.__)("Search and Replace URLs","swish-migrate-and-backup")),(0,s.createElement)("p",{className:"description"},(0,c.__)("Replace old URLs with new ones across your entire database. This is useful when migrating to a new domain.","swish-migrate-and-backup")),(0,s.createElement)("div",{className:"swish-migrate-form"},(0,s.createElement)("div",{className:"swish-form-row"},(0,s.createElement)("label",{htmlFor:"search_url"},(0,c.__)("Search for (old URL)","swish-migrate-and-backup")),(0,s.createElement)("input",{type:"url",id:"search_url",className:"regular-text",placeholder:"https://old-domain.com",value:a,onChange:e=>t(e.target.value)})),(0,s.createElement)("div",{className:"swish-form-row"},(0,s.createElement)("label",{htmlFor:"replace_url"},(0,c.__)("Replace with (new URL)","swish-migrate-and-backup")),(0,s.createElement)("input",{type:"url",id:"replace_url",className:"regular-text",placeholder:"https://new-domain.com",value:l,onChange:e=>i(e.target.value)})),(0,s.createElement)("div",{className:"swish-form-actions"},(0,s.createElement)("button",{className:"button",onClick:async()=>{if(a&&l){u(!0),b(null),o(null);try{const e=await g(a,l,!0);o(e)}catch(e){b(e.message||(0,c.__)("Preview failed","swish-migrate-and-backup"))}finally{u(!1)}}else b((0,c.__)("Please enter both search and replace URLs.","swish-migrate-and-backup"))},disabled:m||!a||!l},m?(0,c.__)("Loading...","swish-migrate-and-backup"):(0,c.__)("Preview Changes","swish-migrate-and-backup")),r&&(0,s.createElement)("button",{className:"button button-primary",onClick:async()=>{if(window.confirm((0,c.__)("This will permanently modify your database. Are you sure you want to continue?","swish-migrate-and-backup"))){u(!0),b(null),h(null);try{const e=await g(a,l,!1);h(e),o(null)}catch(e){b(e.message||(0,c.__)("Migration failed","swish-migrate-and-backup"))}finally{u(!1)}}},disabled:m},(0,c.__)("Run Migration","swish-migrate-and-backup")))),p&&(0,s.createElement)("div",{className:"swish-notice swish-notice-error"},(0,s.createElement)("p",null,p)),r&&(0,s.createElement)("div",{className:"swish-preview-results"},(0,s.createElement)("h4",null,(0,c.__)("Preview Results","swish-migrate-and-backup")),(0,s.createElement)("p",null,(0,c.__)("Found","swish-migrate-and-backup")," ",(0,s.createElement)("strong",null,r.total_replacements||0)," ",(0,c.__)("replacements across","swish-migrate-and-backup")," ",(0,s.createElement)("strong",null,r.tables_affected||0)," ",(0,c.__)("tables.","swish-migrate-and-backup")),r.details&&r.details.length>0&&(0,s.createElement)("table",{className:"widefat"},(0,s.createElement)("thead",null,(0,s.createElement)("tr",null,(0,s.createElement)("th",null,(0,c.__)("Table","swish-migrate-and-backup")),(0,s.createElement)("th",null,(0,c.__)("Column","swish-migrate-and-backup")),(0,s.createElement)("th",null,(0,c.__)("Replacements","swish-migrate-and-backup")))),(0,s.createElement)("tbody",null,r.details.slice(0,10).map((e,a)=>(0,s.createElement)("tr",{key:a},(0,s.createElement)("td",null,e.table),(0,s.createElement)("td",null,e.column),(0,s.createElement)("td",null,e.count)))))),d&&(0,s.createElement)("div",{className:"swish-notice swish-notice-success"},(0,s.createElement)("p",null,(0,s.createElement)("strong",null,(0,c.__)("Migration completed!","swish-migrate-and-backup"))," ",(0,c.__)("Replaced","swish-migrate-and-backup")," ",(0,s.createElement)("strong",null,d.total_replacements||0)," ",(0,c.__)("occurrences.","swish-migrate-and-backup"))))},v=({stats:e,backups:a,settings:t,onBackup:l,onDelete:r,onDownload:o,onRestore:m,onOpenSettings:u})=>{const[d,h]=(0,n.useState)(!1),[p,b]=(0,n.useState)(!1);return(0,s.createElement)("div",{className:"swish-dashboard"},(0,s.createElement)("div",{className:"swish-dashboard-header"},(0,s.createElement)("h1",null,(0,c.__)("Swish Backup","swish-migrate-and-backup")),(0,s.createElement)("button",{className:"button button-link",onClick:u},(0,s.createElement)("span",{className:"dashicons dashicons-admin-settings"}),(0,c.__)("Settings","swish-migrate-and-backup"))),(0,s.createElement)("div",{className:"swish-quick-actions"},(0,s.createElement)("div",{className:"swish-action-card"},(0,s.createElement)("h3",null,(0,c.__)("Backup Now","swish-migrate-and-backup")),(0,s.createElement)("p",null,(0,c.__)("Create a new backup of your site.","swish-migrate-and-backup")),d?(0,s.createElement)("div",{className:"swish-backup-types"},(0,s.createElement)("button",{className:"button button-primary",onClick:()=>{h(!1),l("full")}},(0,c.__)("Full Backup","swish-migrate-and-backup")),(0,s.createElement)("button",{className:"button",onClick:()=>{h(!1),l("database")}},(0,c.__)("Database Only","swish-migrate-and-backup")),(0,s.createElement)("button",{className:"button",onClick:()=>{h(!1),l("files")}},(0,c.__)("Files Only","swish-migrate-and-backup")),(0,s.createElement)("button",{className:"button button-link",onClick:()=>h(!1)},(0,c.__)("Cancel","swish-migrate-and-backup"))):(0,s.createElement)("button",{className:"button button-primary button-hero",onClick:()=>h(!0)},(0,s.createElement)("span",{className:"dashicons dashicons-backup"}),(0,c.__)("Create Backup","swish-migrate-and-backup"))),(0,s.createElement)("div",{className:"swish-action-card"},(0,s.createElement)("h3",null,(0,c.__)("Migrate Site","swish-migrate-and-backup")),(0,s.createElement)("p",null,(0,c.__)("Search and replace URLs in the database.","swish-migrate-and-backup")),(0,s.createElement)("button",{className:"button button-hero",onClick:()=>b(!p)},(0,s.createElement)("span",{className:"dashicons dashicons-migrate"}),p?(0,c.__)("Hide Migration","swish-migrate-and-backup"):(0,c.__)("Start Migration","swish-migrate-and-backup")))),p&&(0,s.createElement)(N,{siteUrl:e?.site_url}),(0,s.createElement)("div",{className:"swish-stats-grid"},(0,s.createElement)("div",{className:"swish-stat-card"},(0,s.createElement)("span",{className:"dashicons dashicons-backup"}),(0,s.createElement)("div",{className:"swish-stat-content"},(0,s.createElement)("span",{className:"swish-stat-value"},e?.total_backups||0),(0,s.createElement)("span",{className:"swish-stat-label"},(0,c.__)("Total Backups","swish-migrate-and-backup")))),(0,s.createElement)("div",{className:"swish-stat-card"},(0,s.createElement)("span",{className:"dashicons dashicons-database"}),(0,s.createElement)("div",{className:"swish-stat-content"},(0,s.createElement)("span",{className:"swish-stat-value"},(e=>{if(0===e)return"0 Bytes";const a=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,a)).toFixed(2))+" "+["Bytes","KB","MB","GB"][a]})(e?.total_size||0)),(0,s.createElement)("span",{className:"swish-stat-label"},(0,c.__)("Storage Used","swish-migrate-and-backup")))),(0,s.createElement)("div",{className:"swish-stat-card"},(0,s.createElement)("span",{className:"dashicons dashicons-calendar-alt"}),(0,s.createElement)("div",{className:"swish-stat-content"},(0,s.createElement)("span",{className:"swish-stat-value"},e?.last_backup?(e=>{if(!e)return"-";const a=new Date(e);return a.toLocaleDateString()+" "+a.toLocaleTimeString()})(e.last_backup.completed_at):(0,c.__)("Never","swish-migrate-and-backup")),(0,s.createElement)("span",{className:"swish-stat-label"},(0,c.__)("Last Backup","swish-migrate-and-backup")))),(0,s.createElement)("div",{className:"swish-stat-card"},(0,s.createElement)("span",{className:"dashicons dashicons-performance"}),(0,s.createElement)("div",{className:"swish-stat-content"},(0,s.createElement)("span",{className:"swish-stat-value"},t?.db_batch_size||500," / ",t?.file_batch_size||100),(0,s.createElement)("span",{className:"swish-stat-label"},(0,c.__)("Batch Size (DB/Files)","swish-migrate-and-backup"))))),e?.storage&&Object.keys(e.storage).length>0&&(0,s.createElement)("div",{className:"swish-storage-status"},(0,s.createElement)("h2",null,(0,c.__)("Storage Destinations","swish-migrate-and-backup")),(0,s.createElement)("div",{className:"swish-storage-grid"},Object.entries(e.storage).map(([e,a])=>(0,s.createElement)("div",{key:e,className:"swish-storage-card "+(a.configured?"configured":"")},(0,s.createElement)("span",{className:"swish-storage-icon dashicons dashicons-cloud"}),(0,s.createElement)("span",{className:"swish-storage-name"},a.name),(0,s.createElement)("span",{className:"swish-storage-status-badge "+(a.configured?"active":"inactive")},a.configured?(0,c.__)("Connected","swish-migrate-and-backup"):(0,c.__)("Not Configured","swish-migrate-and-backup")))))),(0,s.createElement)(i,{backups:a,onDelete:r,onDownload:o,onRestore:m}))},f=({job:e,onClose:a})=>{if(!e)return null;const t="processing"===e.status||"starting"===e.status,n="completed"===e.status,l="failed"===e.status,i=()=>n?"status-completed":l?"status-failed":"status-processing";return(0,s.createElement)("div",{className:"swish-modal-overlay"},(0,s.createElement)("div",{className:"swish-modal"},(0,s.createElement)("div",{className:"swish-modal-header"},(0,s.createElement)("h2",null,(0,s.createElement)("span",{className:`dashicons dashicons-${n?"yes-alt":l?"warning":"update"} ${t?"spin":""}`}),n&&(0,c.__)("Operation Complete","swish-migrate-and-backup"),l&&(0,c.__)("Operation Failed","swish-migrate-and-backup"),t&&(0,c.__)("Operation in Progress","swish-migrate-and-backup"))),(0,s.createElement)("div",{className:"swish-modal-body"},(0,s.createElement)("div",{className:"swish-progress-container"},(0,s.createElement)("div",{className:`swish-progress-bar ${i()}`},(0,s.createElement)("div",{className:"swish-progress-fill",style:{width:`${e.progress||0}%`}})),(0,s.createElement)("div",{className:"swish-progress-text"},(0,s.createElement)("span",{className:"swish-progress-percent"},e.progress||0,"%"))),(0,s.createElement)("div",{className:`swish-status-message ${i()}`},e.message||(0,c.__)("Processing...","swish-migrate-and-backup")),t&&(0,s.createElement)("div",{className:"swish-processing-dots"},(0,s.createElement)("span",null),(0,s.createElement)("span",null),(0,s.createElement)("span",null))),(0,s.createElement)("div",{className:"swish-modal-footer"},!t&&(0,s.createElement)("button",{className:"button button-primary",onClick:a},(0,c.__)("Close","swish-migrate-and-backup")),t&&(0,s.createElement)("p",{className:"swish-processing-notice"},(0,c.__)("Please wait while the operation completes. Do not close this window.","swish-migrate-and-backup")))))},y=({settings:e,onSave:a,onClose:t})=>{const[l,i]=(0,n.useState)({...e}),[r,o]=(0,n.useState)(!1),m=(e,a)=>{i(t=>({...t,[e]:a}))};return(0,s.createElement)("div",{className:"swish-modal-overlay"},(0,s.createElement)("div",{className:"swish-modal swish-settings-modal"},(0,s.createElement)("div",{className:"swish-modal-header"},(0,s.createElement)("h2",null,(0,s.createElement)("span",{className:"dashicons dashicons-admin-settings"}),(0,c.__)("Backup Settings","swish-migrate-and-backup")),(0,s.createElement)("button",{className:"swish-modal-close",onClick:t},(0,s.createElement)("span",{className:"dashicons dashicons-no-alt"}))),(0,s.createElement)("div",{className:"swish-modal-body"},(0,s.createElement)("div",{className:"swish-settings-section"},(0,s.createElement)("h3",null,(0,c.__)("Performance Settings","swish-migrate-and-backup")),(0,s.createElement)("p",{className:"description"},(0,c.__)("Adjust batch sizes to optimize performance for your hosting environment. Lower values are safer for shared hosting.","swish-migrate-and-backup")),(0,s.createElement)("div",{className:"swish-setting-row"},(0,s.createElement)("label",{htmlFor:"db_batch_size"},(0,c.__)("Database Batch Size","swish-migrate-and-backup"),(0,s.createElement)("span",{className:"swish-setting-hint"},(0,c.__)("(rows per batch: 50-2000)","swish-migrate-and-backup"))),(0,s.createElement)("div",{className:"swish-range-input"},(0,s.createElement)("input",{type:"range",id:"db_batch_size",min:"50",max:"2000",step:"50",value:l.db_batch_size||500,onChange:e=>m("db_batch_size",parseInt(e.target.value,10))}),(0,s.createElement)("span",{className:"swish-range-value"},l.db_batch_size||500)),(0,s.createElement)("div",{className:"swish-preset-buttons"},(0,s.createElement)("button",{type:"button",className:"button button-small",onClick:()=>m("db_batch_size",100)},(0,c.__)("Slow (100)","swish-migrate-and-backup")),(0,s.createElement)("button",{type:"button",className:"button button-small",onClick:()=>m("db_batch_size",500)},(0,c.__)("Balanced (500)","swish-migrate-and-backup")),(0,s.createElement)("button",{type:"button",className:"button button-small",onClick:()=>m("db_batch_size",1e3)},(0,c.__)("Fast (1000)","swish-migrate-and-backup")))),(0,s.createElement)("div",{className:"swish-setting-row"},(0,s.createElement)("label",{htmlFor:"file_batch_size"},(0,c.__)("File Batch Size","swish-migrate-and-backup"),(0,s.createElement)("span",{className:"swish-setting-hint"},(0,c.__)("(files per batch: 25-500)","swish-migrate-and-backup"))),(0,s.createElement)("div",{className:"swish-range-input"},(0,s.createElement)("input",{type:"range",id:"file_batch_size",min:"25",max:"500",step:"25",value:l.file_batch_size||100,onChange:e=>m("file_batch_size",parseInt(e.target.value,10))}),(0,s.createElement)("span",{className:"swish-range-value"},l.file_batch_size||100)),(0,s.createElement)("div",{className:"swish-preset-buttons"},(0,s.createElement)("button",{type:"button",className:"button button-small",onClick:()=>m("file_batch_size",50)},(0,c.__)("Slow (50)","swish-migrate-and-backup")),(0,s.createElement)("button",{type:"button",className:"button button-small",onClick:()=>m("file_batch_size",100)},(0,c.__)("Balanced (100)","swish-migrate-and-backup")),(0,s.createElement)("button",{type:"button",className:"button button-small",onClick:()=>m("file_batch_size",250)},(0,c.__)("Fast (250)","swish-migrate-and-backup"))))),(0,s.createElement)("div",{className:"swish-settings-section"},(0,s.createElement)("h3",null,(0,c.__)("Backup Contents","swish-migrate-and-backup")),(0,s.createElement)("div",{className:"swish-checkbox-group"},(0,s.createElement)("label",null,(0,s.createElement)("input",{type:"checkbox",checked:!1!==l.backup_database,onChange:e=>m("backup_database",e.target.checked)}),(0,c.__)("Database","swish-migrate-and-backup")),(0,s.createElement)("label",null,(0,s.createElement)("input",{type:"checkbox",checked:!1!==l.backup_plugins,onChange:e=>m("backup_plugins",e.target.checked)}),(0,c.__)("Plugins","swish-migrate-and-backup")),(0,s.createElement)("label",null,(0,s.createElement)("input",{type:"checkbox",checked:!1!==l.backup_themes,onChange:e=>m("backup_themes",e.target.checked)}),(0,c.__)("Themes","swish-migrate-and-backup")),(0,s.createElement)("label",null,(0,s.createElement)("input",{type:"checkbox",checked:!1!==l.backup_uploads,onChange:e=>m("backup_uploads",e.target.checked)}),(0,c.__)("Uploads","swish-migrate-and-backup")),(0,s.createElement)("label",null,(0,s.createElement)("input",{type:"checkbox",checked:!1!==l.backup_core_files,onChange:e=>m("backup_core_files",e.target.checked)}),(0,c.__)("Core Files","swish-migrate-and-backup")))),(0,s.createElement)("div",{className:"swish-settings-section"},(0,s.createElement)("h3",null,(0,c.__)("Hosting Presets","swish-migrate-and-backup")),(0,s.createElement)("p",{className:"description"},(0,c.__)("Quick presets for common hosting environments.","swish-migrate-and-backup")),(0,s.createElement)("div",{className:"swish-preset-buttons hosting-presets"},(0,s.createElement)("button",{type:"button",className:"button",onClick:()=>{m("db_batch_size",100),m("file_batch_size",50)}},(0,c.__)("Shared Hosting","swish-migrate-and-backup")),(0,s.createElement)("button",{type:"button",className:"button",onClick:()=>{m("db_batch_size",500),m("file_batch_size",100)}},(0,c.__)("VPS / Managed","swish-migrate-and-backup")),(0,s.createElement)("button",{type:"button",className:"button",onClick:()=>{m("db_batch_size",1e3),m("file_batch_size",250)}},(0,c.__)("Dedicated Server","swish-migrate-and-backup"))))),(0,s.createElement)("div",{className:"swish-modal-footer"},(0,s.createElement)("button",{className:"button",onClick:t,disabled:r},(0,c.__)("Cancel","swish-migrate-and-backup")),(0,s.createElement)("button",{className:"button button-primary",onClick:async()=>{o(!0),await a(l),o(!1),t()},disabled:r},r?(0,c.__)("Saving...","swish-migrate-and-backup"):(0,c.__)("Save Settings","swish-migrate-and-backup")))))},C=()=>{const[e,a]=(0,n.useState)(null),[t,c]=(0,n.useState)([]),[i,r]=(0,n.useState)(null),[o,m]=(0,n.useState)(!0),[g,N]=(0,n.useState)(null),[C,S]=(0,n.useState)(null),[z,B]=(0,n.useState)(!1),[R,O]=(0,n.useState)(!1);(0,n.useEffect)(()=>{F()},[]);const F=async()=>{try{m(!0),N(null);const[e,t,s]=await Promise.all([u(),d(),k()]);a(e),c(t),r(s)}catch(e){N(e.message||"Failed to load dashboard data")}finally{m(!1)}},D=(0,n.useCallback)(async e=>{try{B(!0),S({status:"starting",progress:0,message:"Initializing backup..."});const a=await h(e,{db_batch_size:i?.db_batch_size||500,file_batch_size:i?.file_batch_size||100});a.job_id?M(a.job_id):(S({status:"completed",progress:100,message:"Backup completed successfully!"}),F())}catch(e){S({status:"failed",progress:0,message:e.message||"Backup failed"})}},[i]),M=(0,n.useCallback)(async e=>{const a=async()=>{try{const t=await w(e);S({status:t.status,progress:t.progress,message:t.message||`Progress: ${t.progress}%`}),"completed"===t.status?setTimeout(()=>{B(!1),F()},1500):"failed"===t.status||setTimeout(a,500)}catch(e){S({status:"failed",progress:0,message:e.message||"Failed to get job status"})}};a()},[]),P=(0,n.useCallback)(async e=>{if(window.confirm("Are you sure you want to delete this backup?"))try{await p(e),F()}catch(e){alert(e.message||"Failed to delete backup")}},[]),T=(0,n.useCallback)(async e=>{try{const a=await b(e);a.url&&(window.location.href=a.url)}catch(e){alert(e.message||"Failed to get download URL")}},[]),x=(0,n.useCallback)(async e=>{if(window.confirm("Are you sure you want to restore this backup? This will overwrite your current site data."))try{B(!0),S({status:"processing",progress:0,message:"Restoring backup..."}),await _(e),S({status:"completed",progress:100,message:"Restore completed successfully!"}),setTimeout(()=>{window.location.reload()},2e3)}catch(e){S({status:"failed",progress:0,message:e.message||"Restore failed"})}},[]),L=(0,n.useCallback)(async e=>{try{const a=await E(e);a.success&&r(a.settings)}catch(e){alert(e.message||"Failed to update settings")}},[]),j=(0,n.useCallback)(()=>{"processing"!==C?.status&&(B(!1),S(null))},[C]);return o?(0,s.createElement)("div",{className:"swish-loading"},(0,s.createElement)(l.Spinner,null),(0,s.createElement)("p",null,"Loading dashboard...")):g?(0,s.createElement)("div",{className:"swish-error"},(0,s.createElement)("p",null,"Error: ",g),(0,s.createElement)("button",{onClick:F,className:"button"},"Retry")):(0,s.createElement)("div",{className:"swish-dashboard-app"},(0,s.createElement)(v,{stats:e,backups:t,settings:i,onBackup:D,onDelete:P,onDownload:T,onRestore:x,onOpenSettings:()=>O(!0)}),z&&(0,s.createElement)(f,{job:C,onClose:j}),R&&(0,s.createElement)(y,{settings:i,onSave:L,onClose:()=>O(!1)}))};document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("swish-backup-dashboard");e&&(0,n.createRoot)(e).render((0,s.createElement)(C,null))})}},t={};function s(e){var n=t[e];if(void 0!==n)return n.exports;var l=t[e]={exports:{}};return a[e](l,l.exports,s),l.exports}s.m=a,e=[],s.O=(a,t,n,l)=>{if(!t){var c=1/0;for(m=0;m<e.length;m++){for(var[t,n,l]=e[m],i=!0,r=0;r<t.length;r++)(!1&l||c>=l)&&Object.keys(s.O).every(e=>s.O[e](t[r]))?t.splice(r--,1):(i=!1,l<c&&(c=l));if(i){e.splice(m--,1);var o=n();void 0!==o&&(a=o)}}return a}l=l||0;for(var m=e.length;m>0&&e[m-1][2]>l;m--)e[m]=e[m-1];e[m]=[t,n,l]},s.n=e=>{var a=e&&e.__esModule?()=>e.default:()=>e;return s.d(a,{a}),a},s.d=(e,a)=>{for(var t in a)s.o(a,t)&&!s.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:a[t]})},s.o=(e,a)=>Object.prototype.hasOwnProperty.call(e,a),(()=>{var e={57:0,350:0};s.O.j=a=>0===e[a];var a=(a,t)=>{var n,l,[c,i,r]=t,o=0;if(c.some(a=>0!==e[a])){for(n in i)s.o(i,n)&&(s.m[n]=i[n]);if(r)var m=r(s)}for(a&&a(t);o<c.length;o++)l=c[o],s.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return s.O(m)},t=globalThis.webpackChunkswish_migrate_and_backup=globalThis.webpackChunkswish_migrate_and_backup||[];t.forEach(a.bind(null,0)),t.push=a.bind(null,t.push.bind(t))})();var n=s.O(void 0,[350],()=>s(865));n=s.O(n)})();